<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5x5 Neon Mini Chess – 1v1</title>
<style>
  body {
    background: #000;
    color: #0ff;
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    padding: 0;
  }
  h1 { text-shadow: 0 0 10px #0ff; }
  .board {
    display: grid;
    grid-template-columns: repeat(5, 80px);
    grid-template-rows: repeat(5, 80px);
    border: 4px solid #0ff;
    box-shadow: 0 0 20px #0ff;
  }
  .cell {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    cursor: pointer;
    user-select: none;
    transition: 0.2s;
  }
  .cell:nth-child(odd) { background: #1a1a1a; }
  .cell:nth-child(even) { background: #111; }
  .white-piece { color: #fff; text-shadow: 0 0 8px #0ff; }
  .black-piece { color: #000; text-shadow: 0 0 8px #0ff; }
  .highlight { box-shadow: 0 0 15px #0ff inset; }
  .capture { box-shadow: 0 0 20px red inset; }
  #controls { margin: 10px; display: flex; gap: 10px; }
  button {
    background: #0ff;
    color: #000;
    border: none;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover { background: #fff; }
  #move-history {
    width: 300px;
    height: 120px;
    overflow-y: auto;
    border: 1px solid #0ff5;
    margin-top: 10px;
    padding: 5px;
    font-size: 14px;
  }
  #turn-indicator { font-weight: bold; text-shadow: 0 0 8px #0ff; margin-bottom: 5px; }
  .selected { outline: 2px solid #ff0; }
  #checkmate-overlay { animation: fadeIn 0.5s ease forwards; }
  @keyframes fadeIn { from {opacity: 0} to {opacity: 1} }
</style>
</head>
<body>
<h1>5x5 Neon Mini Chess – 1v1</h1>
<div id="turn-indicator">Status: Waiting to Start</div>

<div class="board" id="chessboard"></div>

<div style="display:flex; gap:20px; margin-top:10px;">
  <div>
    <div style="font-weight:bold; text-shadow:0 0 8px #0ff;">Captured by White:</div>
    <div id="white-captured" style="min-height:40px; border:1px solid #0ff; padding:5px;"></div>
  </div>
  <div>
    <div style="font-weight:bold; text-shadow:0 0 8px #0ff;">Captured by Black:</div>
    <div id="black-captured" style="min-height:40px; border:1px solid #0ff; padding:5px;"></div>
  </div>
</div>

<div id="controls">
  <button id="startBtn">Start</button>
  <button id="pauseBtn" disabled>Pause</button>
  <button id="resetBtn">Reset</button>
</div>

<ul id="move-history"></ul>

<script>
let selectedCell = null;
let currentPlayer = 'white';
let gameStarted = false;
let gamePaused = false;

const pieceMap = {
  '♔':'white', '♗':'white', '♘':'white', '♙':'white',
  '♚':'black', '♝':'black', '♞':'black', '♟':'black'
};

// ----- Board Setup -----
const board = document.getElementById('chessboard');
const boardSize = 5;
const whitePieces = ['♙','♘','♔','♗','♙'];
const blackPieces = ['♟','♝','♚','♞','♟'];

function createBoard(){
  board.innerHTML = '';
  for(let r=0; r<boardSize; r++){
    for(let c=0; c<boardSize; c++){
      const cell = document.createElement('div');
      cell.dataset.row = r;
      cell.dataset.col = c;
      cell.classList.add('cell');
      cell.addEventListener('click', ()=>onCellClick(cell));

      if(r===0){ cell.textContent = blackPieces[c]; cell.classList.add('black-piece'); }
      if(r===4){ cell.textContent = whitePieces[c]; cell.classList.add('white-piece'); }

      board.appendChild(cell);
    }
  }
}

// ----- Helpers -----
function getPiece(cell){ return cell ? cell.textContent.trim() : ''; }
function getPieceOwner(cell){ const p=getPiece(cell); return pieceMap[p]||null; }
function isInBounds(r,c){ return r>=0 && r<boardSize && c>=0 && c<boardSize; }
function clearHighlights(){ document.querySelectorAll('.cell').forEach(c=>c.classList.remove('highlight','capture','selected')); }

function highlightMoves(moves){
  clearHighlights();
  moves.forEach(c=>{
    if(!c) return;
    c.classList.add(getPiece(c)?'capture':'highlight');
  });
}

function getValidMoves(cell){
  if(!cell) return [];
  const piece=getPiece(cell);
  const owner=getPieceOwner(cell);
  if(!piece || !owner) return [];

  const r=parseInt(cell.dataset.row), c=parseInt(cell.dataset.col);
  const moves=[];
  const add=(nr,nc)=>{
    if(!isInBounds(nr,nc)) return;
    const t=document.querySelector(`[data-row="${nr}"][data-col="${nc}"]`);
    if(t && getPieceOwner(t)!==owner) moves.push(t);
  };

  // Pawn
  if(piece==='♙'){
    const f=document.querySelector(`[data-row="${r-1}"][data-col="${c}"]`);
    if(f && !getPiece(f)) moves.push(f);
    [[-1,-1],[-1,1]].forEach(([dr,dc])=>{
      const t=document.querySelector(`[data-row="${r+dr}"][data-col="${c+dc}"]`);
      if(t && getPieceOwner(t)==='black') moves.push(t);
    });
    return moves;
  }

  if(piece==='♟'){
    const f=document.querySelector(`[data-row="${r+1}"][data-col="${c}"]`);
    if(f && !getPiece(f)) moves.push(f);
    [[1,-1],[1,1]].forEach(([dr,dc])=>{
      const t=document.querySelector(`[data-row="${r+dr}"][data-col="${c+dc}"]`);
      if(t && getPieceOwner(t)==='white') moves.push(t);
    });
    return moves;
  }

  // Knight
  if(piece==='♘'||piece==='♞'){
    [[2,1],[2,-1],[-2,1],[-2,-1],[1,2],[1,-2],[-1,2],[-1,-2]].forEach(([dr,dc])=>add(r+dr,c+dc));
    return moves;
  }

  // Bishop
  if(piece==='♗'||piece==='♝'){
    [[1,1],[1,-1],[-1,1],[-1,-1]].forEach(([dr,dc])=>{
      let nr=r+dr,nc=c+dc;
      while(isInBounds(nr,nc)){
        const t=document.querySelector(`[data-row="${nr}"][data-col="${nc}"]`);
        if(!getPiece(t)) moves.push(t);
        else { if(getPieceOwner(t)!==owner) moves.push(t); break; }
        nr+=dr; nc+=dc;
      }
    });
  }

  // King
  if(piece==='♔'||piece==='♚'){
    for(let dr=-1; dr<=1; dr++)
      for(let dc=-1; dc<=1; dc++)
        if(dr||dc) add(r+dr,c+dc);
  }

  return moves;
}

// ----- Click Handling -----
function onCellClick(cell){
  if(!gameStarted || gamePaused) return;
  const owner=getPieceOwner(cell);
  if(selectedCell){
    const legal=getValidMoves(selectedCell);
    if(legal.includes(cell)){
      movePiece(selectedCell,cell);
    } else {
      selectedCell.classList.remove('selected');
      selectedCell=null;
      clearHighlights();
    }
  } else if(owner===currentPlayer){
    selectedCell=cell;
    cell.classList.add('selected');
    highlightMoves(getValidMoves(cell));
  }
}

// ----- Move Piece -----
function movePiece(from,to){
  const piece=getPiece(from);
  const captured=getPiece(to);
  if(!piece) return;

  to.textContent=piece;
  to.classList.remove('white-piece','black-piece');
  to.classList.add(currentPlayer+'-piece');
  from.textContent='';

  if(captured){
    document.getElementById(
      currentPlayer==='white'?'white-captured':'black-captured'
    ).innerHTML += captured + ' ';
  }

  addMoveHistory(`${currentPlayer.toUpperCase()}: ${piece} ${from.dataset.row}-${from.dataset.col} → ${to.dataset.row}-${to.dataset.col}${captured?` (captured ${captured})`:''}`);

  if(captured==='♚'||captured==='♔'){ showCheckmate(currentPlayer); return; }

  currentPlayer = currentPlayer==='white'?'black':'white';
  document.getElementById('turn-indicator').textContent=`Turn: ${currentPlayer.toUpperCase()}`;
  clearHighlights();
  selectedCell=null;
}

// ----- Move History -----
const moveHistory=document.getElementById('move-history');
function addMoveHistory(text){
  const li=document.createElement('li');
  li.textContent=text;
  moveHistory.appendChild(li);
  moveHistory.scrollTop=moveHistory.scrollHeight;
}

// ----- Checkmate -----
function showCheckmate(winner){
  gameStarted=false;
  const overlay=document.createElement('div');
  overlay.id='checkmate-overlay';
  Object.assign(overlay.style,{
    position:'fixed', inset:0, display:'flex',
    alignItems:'center', justifyContent:'center',
    background:'rgba(0,0,0,0.6)', zIndex:9999,
    color:'#0ff', fontSize:'clamp(1.5rem,3vw,3rem)',
    textAlign:'center', flexDirection:'column', gap:'1rem'
  });
  overlay.innerHTML=`
    <div style="padding:20px 30px; border:3px solid #0ff; box-shadow:0 0 30px #0ff; border-radius:12px;">
      <div style="font-weight:900;">CHECKMATE</div>
      <div style="margin-top:8px;">${winner.toUpperCase()} WINS</div>
      <button id="cm-restart" style="margin-top:12px;padding:10px 18px;border-radius:10px;border:none;cursor:pointer;font-weight:bold;">Restart</button>
    </div>`;
  document.body.appendChild(overlay);
  document.getElementById('cm-restart').onclick=()=>{ document.body.removeChild(overlay); location.reload(); };
}

// ----- Controls -----
const startBtn=document.getElementById('startBtn');
const pauseBtn=document.getElementById('pauseBtn');
startBtn.onclick=()=>{ gameStarted=true; gamePaused=false; currentPlayer='white'; startBtn.disabled=true; pauseBtn.disabled=false; document.getElementById('turn-indicator').textContent='Turn: WHITE'; };
pauseBtn.onclick=()=>{ gamePaused=true; document.getElementById('turn-indicator').textContent='Game Paused'; };
document.getElementById('resetBtn').onclick=()=>{ createBoard(); moveHistory.innerHTML=''; gameStarted=false; gamePaused=false; selectedCell=null; currentPlayer='white'; startBtn.disabled=false; pauseBtn.disabled=true; document.getElementById('turn-indicator').textContent='Status: Waiting to Start'; };

// ----- Initialize -----
createBoard();
</script>
</body>
</html>
